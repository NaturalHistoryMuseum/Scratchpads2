/*! wavesurfer.js 1.4.0 (Tue, 09 Oct 2018 15:21:58 GMT)
* https://github.com/katspaugh/wavesurfer.js
* @license BSD-3-Clause */
!function(e,i){void 0===e&&void 0!==window&&(e=window),"function"==typeof define&&define.amd?define(["wavesurfer"],function(e){return i(e)}):"object"==typeof module&&module.exports?module.exports=i(require("wavesurfer.js")):i(e.WaveSurfer)}(this,function(r){"use strict";r.Minimap=r.util.extend({},r.Drawer,r.Drawer.Canvas,{init:function(e,i){this.wavesurfer=e,this.container=this.wavesurfer.drawer.container,this.lastPos=this.wavesurfer.drawer.lastPos,this.params=e.util.extend({},this.wavesurfer.drawer.params,{showRegions:!1,showOverview:!1,overviewBorderColor:"green",overviewBorderSize:2},i,{scrollParent:!1,fillParent:!0}),this.width=0,this.height=this.params.height*this.params.pixelRatio,this.createWrapper(),this.createElements(),r.Regions&&this.params.showRegions&&this.regions(),this.bindWaveSurferEvents(),this.bindMinimapEvents()},regions:function(){var i=this;this.regions={},this.wavesurfer.on("region-created",function(e){i.regions[e.id]=e,i.renderRegions()}),this.wavesurfer.on("region-updated",function(e){i.regions[e.id]=e,i.renderRegions()}),this.wavesurfer.on("region-removed",function(e){delete i.regions[e.id],i.renderRegions()})},renderRegions:function(){for(var n=this,e=this.wrapper.querySelectorAll("region"),i=0;i<e.length;++i)this.wrapper.removeChild(e[i]);Object.keys(this.regions).forEach(function(e){var i=n.regions[e],r=n.width*((i.end-i.start)/n.wavesurfer.getDuration()),t=n.width*(i.start/n.wavesurfer.getDuration()),s=n.style(document.createElement("region"),{height:"inherit",backgroundColor:i.color,width:r+"px",left:t+"px",display:"block",position:"absolute"});s.classList.add(e),n.wrapper.appendChild(s)})},createElements:function(){r.Drawer.Canvas.createElements.call(this),this.params.showOverview&&(this.overviewRegion=this.style(document.createElement("overview"),{height:this.wrapper.offsetHeight-2*this.params.overviewBorderSize+"px",width:"0px",display:"block",position:"absolute",cursor:"move",border:this.params.overviewBorderSize+"px solid "+this.params.overviewBorderColor,zIndex:2,opacity:this.params.overviewOpacity}),this.wrapper.appendChild(this.overviewRegion))},bindWaveSurferEvents:function(){var i=this;this.render(),this.wavesurfer.on("audioprocess",function(e){i.progress(i.wavesurfer.backend.getPlayedPercents())}),this.wavesurfer.on("seek",function(e){i.progress(i.wavesurfer.backend.getPlayedPercents())}),this.params.showOverview&&(this.wavesurfer.on("scroll",function(e){i.draggingOverview||i.moveOverviewRegion(e.target.scrollLeft/i.ratio)}),this.wavesurfer.drawer.wrapper.addEventListener("mouseover",function(e){i.draggingOverview&&(i.draggingOverview=!1)}));var e=0,r=this.wavesurfer.util.debounce(function(){e!=i.wrapper.clientWidth&&(e=i.wrapper.clientWidth,i.render(),i.progress(i.wavesurfer.backend.getPlayedPercents()))},100);window.addEventListener("resize",r,!0),window.addEventListener("orientationchange",r,!0),this.wavesurfer.on("destroy",function(){i.destroy.bind(this),window.removeEventListener("resize",r,!0)})},bindMinimapEvents:function(){var i=this,r=0,t=!0,s={clientX:0,clientY:0};this.on("click",function(e,i){t?(this.progress(i),this.wavesurfer.seekAndCenter(i)):t=!0}.bind(this)),this.params.showOverview&&(this.overviewRegion.addEventListener("mousedown",function(e){i.draggingOverview=!0,r=e.layerX,s.clientX=e.clientX,s.clientY=e.clientY}),this.wrapper.addEventListener("mousemove",function(e){i.draggingOverview&&i.moveOverviewRegion(e.clientX-i.container.getBoundingClientRect().left-r)}),this.wrapper.addEventListener("mouseup",function(e){s.clientX-e.clientX==0&&s.clientX-e.clientX==0?(t=!0,i.draggingOverview=!1):i.draggingOverview&&(t=!1,i.draggingOverview=!1)}))},render:function(){var e=this.getWidth(),i=this.wavesurfer.backend.getPeaks(e,0,e);this.drawPeaks(i,e,0,e),this.params.showOverview&&(this.ratio=this.wavesurfer.drawer.width/this.width,this.waveShowedWidth=this.wavesurfer.drawer.width/this.ratio,this.waveWidth=this.wavesurfer.drawer.width,this.overviewWidth=this.width/this.ratio,this.overviewPosition=0,this.overviewRegion.style.width=this.overviewWidth-2*this.params.overviewBorderSize+"px")},moveOverviewRegion:function(e){e<0?this.overviewPosition=0:e+this.overviewWidth<this.width?this.overviewPosition=e:this.overviewPosition=this.width-this.overviewWidth,this.overviewRegion.style.left=this.overviewPosition+"px",this.wavesurfer.drawer.wrapper.scrollLeft=this.overviewPosition*this.ratio}}),r.initMinimap=function(e){var i=Object.create(r.Minimap);return i.init(this,e),i}});